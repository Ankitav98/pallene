/* This file was generated by the Pallene compiler. Do not edit by hand */
/* Indentation and formatting courtesy of pallene/pretty.lua */

#include <string.h>

#include "pallene_core.h"

#include "lua.h"
#include "lauxlib.h"
#include "lualib.h"

#include "lapi.h"
#include "lfunc.h"
#include "lgc.h"
#include "lobject.h"
#include "lstate.h"
#include "lstring.h"
#include "ltable.h"
#include "lvm.h"

#include "math.h"

static Table * function_new_canvas_pallene(
    lua_State * L,
    lua_Integer x1 /* N */,
    lua_Integer x2 /* M */
){
    lua_checkstack(L, 1);
    CClosure * x3 = clCvalue(s2v(L->ci->func));
    Udata * x4 /* upvalue table */ = uvalue(&x3->upvalue[0]);
    UValue * x5 /* upvalue array */ = x4->uv;
    (void)x5;
    {
        luaC_condGC(L, {
        }, {
        });
        Table * x6 = luaH_new(L);
        luaH_resizearray(L, x6, 0);
        TValue * x7 = x6->array;
        (void) x7;
        Table * x8 /* t */ = x6;
        lua_Integer x9 /* start */ = 1;
        lua_Integer x10 /* limit */ = x1;
        lua_Integer x11 /* step */ = 1;
        while ((x11 >= 0 ? x9 <= x10 : x9 >= x10)) {
            lua_Integer x12 /* i */ = x9;
            (void) x12;
            {
                luaC_condGC(L, {
                    StackValue* x13 = L->top;
                    sethvalue(L, s2v(x13), x8); x13++;
                    L->top = x13;
                }, {
                    L->top -= 1;
                });
                Table * x14 = luaH_new(L);
                luaH_resizearray(L, x14, 0);
                TValue * x15 = x14->array;
                (void) x15;
                Table * x16 /* line */ = x14;
                lua_Integer x17 /* start */ = 1;
                lua_Integer x18 /* limit */ = x2;
                lua_Integer x19 /* step */ = 1;
                while ((x19 >= 0 ? x17 <= x18 : x17 >= x18)) {
                    lua_Integer x20 /* j */ = x17;
                    (void) x20;
                    {
                        lua_Unsigned x21 /* ui */ = ((lua_Unsigned)x20) - 1;
                        if (PALLENE_UNLIKELY(x21 >= x16->sizearray)) {
                            pallene_renormalize_array(L, x16, x21, 10);
                        }
                        TValue * x22 /* slot */ = &x16->array[x21];
                        setivalue(x22, 0);
                    }
                    x17 = intop(+, x17, x19);
                }
                lua_Unsigned x23 /* ui */ = ((lua_Unsigned)x12) - 1;
                if (PALLENE_UNLIKELY(x23 >= x8->sizearray)) {
                    pallene_renormalize_array(L, x8, x23, 12);
                }
                TValue * x24 /* slot */ = &x8->array[x23];
                sethvalue(L, x24, x16);
                if (isblack(obj2gco(x8)) && iswhite(obj2gco(x16))) {
                    luaC_barrierback_(L, obj2gco(x8));
                }
            }
            x9 = intop(+, x9, x11);
        }
        return x8;
    }
}

static int function_new_canvas_lua(lua_State *L)
{
    lua_checkstack(L, 1);
    CClosure * x1 = clCvalue(s2v(L->ci->func));
    Udata * x2 /* upvalue table */ = uvalue(&x1->upvalue[0]);
    UValue * x3 /* upvalue array */ = x2->uv;
    (void)x3;
    StackValue* x4 = L->ci->func;
    lua_Integer x8 = ivalue(s2v(x4 + 1));
    lua_Integer x9 = ivalue(s2v(x4 + 2));
    Table * x10 /* ret */ = function_new_canvas_pallene(L, x8, x9);
    sethvalue(L, s2v(L->top), x10);
    api_incr_top(L);
    return 1;
}

static lua_Integer function_wrap_pallene(
    lua_State * L,
    lua_Integer x1 /* i */,
    lua_Integer x2 /* N */
){
    CClosure * x3 = clCvalue(s2v(L->ci->func));
    Udata * x4 /* upvalue table */ = uvalue(&x3->upvalue[0]);
    UValue * x5 /* upvalue array */ = x4->uv;
    (void)x5;
    {
        lua_Integer x6 = intop(-, x1, 1);
        lua_Integer x7;
        if (l_castS2U(x2) + 1u <= 1u) {
            if (x2 == 0){
                pallene_runtime_mod_by_zero_error(L, 19);
            } else {
                x7 = 0;
            }
        } else {
            x7 = x6 % x2;
            if (x7 != 0 && (x6 ^ x2) < 0) {
                x7 += x2;
            }
        }
        lua_Integer x8 = intop(+, x7, 1);
        return x8;
    }
}

static int function_wrap_lua(lua_State *L)
{
    lua_checkstack(L, 1);
    CClosure * x1 = clCvalue(s2v(L->ci->func));
    Udata * x2 /* upvalue table */ = uvalue(&x1->upvalue[0]);
    UValue * x3 /* upvalue array */ = x2->uv;
    (void)x3;
    StackValue* x4 = L->ci->func;
    lua_Integer x8 = ivalue(s2v(x4 + 1));
    lua_Integer x9 = ivalue(s2v(x4 + 2));
    lua_Integer x10 /* ret */ = function_wrap_pallene(L, x8, x9);
    setivalue(s2v(L->top), x10);
    api_incr_top(L);
    return 1;
}

static void function_draw_pallene(
    lua_State * L,
    lua_Integer x1 /* N */,
    lua_Integer x2 /* M */,
    Table * x3 /* cells */
){
    lua_checkstack(L, 3);
    CClosure * x4 = clCvalue(s2v(L->ci->func));
    Udata * x5 /* upvalue table */ = uvalue(&x4->upvalue[0]);
    UValue * x6 /* upvalue array */ = x5->uv;
    (void)x6;
    {
        TValue * x7 =  &x6[5].uv ;
        TString * x8 = tsvalue(x7);
        TString * x9 /* out */ = x8;
        lua_Integer x10 /* start */ = 1;
        lua_Integer x11 /* limit */ = x1;
        lua_Integer x12 /* step */ = 1;
        while ((x12 >= 0 ? x10 <= x11 : x10 >= x11)) {
            lua_Integer x13 /* i */ = x10;
            (void) x13;
            {
                lua_Unsigned x14 /* ui */ = ((lua_Unsigned)x13) - 1;
                if (PALLENE_UNLIKELY(x14 >= x3->sizearray)) {
                    pallene_renormalize_array(L, x3, x14, 26);
                }
                const TValue * x15 /* arrslot */ = &x3->array[x14];
                Table * x16 = hvalue(x15);
                Table * x17 /* cellsi */ = x16;
                TString * x21;
                {
                    luaC_condGC(L, {
                        StackValue* x18 = L->top;
                        sethvalue(L, s2v(x18), x3); x18++;
                        setsvalue(L, s2v(x18), x9); x18++;
                        sethvalue(L, s2v(x18), x17); x18++;
                        L->top = x18;
                    }, {
                        L->top -= 3;
                    });
                    TString *ss[2];
                    ss[0] = x9;
                    TValue * x19 =  &x6[6].uv ;
                    TString * x20 = tsvalue(x19);
                    ss[1] = x20;
                    ;
                    x21 = pallene_string_concatN(L, 2, ss);
                }
                x9 = x21;
                lua_Integer x22 /* start */ = 1;
                lua_Integer x23 /* limit */ = x2;
                lua_Integer x24 /* step */ = 1;
                while ((x24 >= 0 ? x22 <= x23 : x22 >= x23)) {
                    lua_Integer x25 /* j */ = x22;
                    (void) x25;
                    {
                        {
                            lua_Unsigned x26 /* ui */ = ((lua_Unsigned)x25) - 1;
                            if (PALLENE_UNLIKELY(x26 >= x17->sizearray)) {
                                pallene_renormalize_array(L, x17, x26, 29);
                            }
                            const TValue * x27 /* arrslot */ = &x17->array[x26];
                            lua_Integer x28 = ivalue(x27);
                            int x29 = x28 != 0;
                            if (x29) {
                                TString * x33;
                                {
                                    luaC_condGC(L, {
                                        StackValue* x30 = L->top;
                                        sethvalue(L, s2v(x30), x3); x30++;
                                        setsvalue(L, s2v(x30), x9); x30++;
                                        sethvalue(L, s2v(x30), x17); x30++;
                                        L->top = x30;
                                    }, {
                                        L->top -= 3;
                                    });
                                    TString *ss[2];
                                    ss[0] = x9;
                                    TValue * x31 =  &x6[8].uv ;
                                    TString * x32 = tsvalue(x31);
                                    ss[1] = x32;
                                    ;
                                    x33 = pallene_string_concatN(L, 2, ss);
                                }
                                x9 = x33;
                            } else {
                                TString * x37;
                                {
                                    luaC_condGC(L, {
                                        StackValue* x34 = L->top;
                                        sethvalue(L, s2v(x34), x3); x34++;
                                        setsvalue(L, s2v(x34), x9); x34++;
                                        sethvalue(L, s2v(x34), x17); x34++;
                                        L->top = x34;
                                    }, {
                                        L->top -= 3;
                                    });
                                    TString *ss[2];
                                    ss[0] = x9;
                                    TValue * x35 =  &x6[9].uv ;
                                    TString * x36 = tsvalue(x35);
                                    ss[1] = x36;
                                    ;
                                    x37 = pallene_string_concatN(L, 2, ss);
                                }
                                x9 = x37;
                            }
                        }
                    }
                    x22 = intop(+, x22, x24);
                }
                TString * x41;
                {
                    luaC_condGC(L, {
                        StackValue* x38 = L->top;
                        sethvalue(L, s2v(x38), x3); x38++;
                        setsvalue(L, s2v(x38), x9); x38++;
                        sethvalue(L, s2v(x38), x17); x38++;
                        L->top = x38;
                    }, {
                        L->top -= 3;
                    });
                    TString *ss[2];
                    ss[0] = x9;
                    TValue * x39 =  &x6[7].uv ;
                    TString * x40 = tsvalue(x39);
                    ss[1] = x40;
                    ;
                    x41 = pallene_string_concatN(L, 2, ss);
                }
                x9 = x41;
            }
            x10 = intop(+, x10, x12);
        }
        FILE * x42 = stdout; /* TODO: use Lua output file */
        const char * x43 = getstr(x9);
        size_t x44 = tsslen(x9);
        fwrite(x43, sizeof(char), x44, x42);
    }
}

static int function_draw_lua(lua_State *L)
{
    CClosure * x1 = clCvalue(s2v(L->ci->func));
    Udata * x2 /* upvalue table */ = uvalue(&x1->upvalue[0]);
    UValue * x3 /* upvalue array */ = x2->uv;
    (void)x3;
    StackValue* x4 = L->ci->func;
    lua_Integer x9 = ivalue(s2v(x4 + 1));
    lua_Integer x10 = ivalue(s2v(x4 + 2));
    Table * x11 = hvalue(s2v(x4 + 3));
    function_draw_pallene(L, x9, x10, x11);
    return 0;
}

static void function_spawn_pallene(
    lua_State * L,
    lua_Integer x1 /* N */,
    lua_Integer x2 /* M */,
    Table * x3 /* cells */,
    Table * x4 /* shape */,
    lua_Integer x5 /* top */,
    lua_Integer x6 /* left */
){
    lua_checkstack(L, 4);
    CClosure * x7 = clCvalue(s2v(L->ci->func));
    Udata * x8 /* upvalue table */ = uvalue(&x7->upvalue[0]);
    UValue * x9 /* upvalue array */ = x8->uv;
    (void)x9;
    {
        lua_Integer x11 = luaH_getn(x4);
        lua_Integer x10 /* start */ = 1;
        lua_Integer x12 /* limit */ = x11;
        lua_Integer x13 /* step */ = 1;
        while ((x13 >= 0 ? x10 <= x12 : x10 >= x12)) {
            lua_Integer x14 /* i */ = x10;
            (void) x14;
            {
                lua_Integer x15 = intop(+, x14, x5);
                lua_Integer x16 = intop(-, x15, 1);
                StackValue* x17 = L->top;
                sethvalue(L, s2v(x17), x3); x17++;
                sethvalue(L, s2v(x17), x4); x17++;
                L->top = x17;
                lua_Integer x18 = function_wrap_pallene(L, x16, x1);
                L->top -= 2;
                lua_Integer x19 /* ci */ = x18;
                lua_Unsigned x20 /* ui */ = ((lua_Unsigned)x14) - 1;
                if (PALLENE_UNLIKELY(x20 >= x4->sizearray)) {
                    pallene_renormalize_array(L, x4, x20, 45);
                }
                const TValue * x21 /* arrslot */ = &x4->array[x20];
                Table * x22 = hvalue(x21);
                Table * x23 /* shape_row */ = x22;
                lua_Unsigned x24 /* ui */ = ((lua_Unsigned)x19) - 1;
                if (PALLENE_UNLIKELY(x24 >= x3->sizearray)) {
                    pallene_renormalize_array(L, x3, x24, 46);
                }
                const TValue * x25 /* arrslot */ = &x3->array[x24];
                Table * x26 = hvalue(x25);
                Table * x27 /* cell_row */ = x26;
                lua_Integer x29 = luaH_getn(x23);
                lua_Integer x28 /* start */ = 1;
                lua_Integer x30 /* limit */ = x29;
                lua_Integer x31 /* step */ = 1;
                while ((x31 >= 0 ? x28 <= x30 : x28 >= x30)) {
                    lua_Integer x32 /* j */ = x28;
                    (void) x32;
                    {
                        lua_Integer x33 = intop(+, x32, x6);
                        lua_Integer x34 = intop(-, x33, 1);
                        StackValue* x35 = L->top;
                        sethvalue(L, s2v(x35), x3); x35++;
                        sethvalue(L, s2v(x35), x4); x35++;
                        sethvalue(L, s2v(x35), x23); x35++;
                        sethvalue(L, s2v(x35), x27); x35++;
                        L->top = x35;
                        lua_Integer x36 = function_wrap_pallene(L, x34, x2);
                        L->top -= 4;
                        lua_Integer x37 /* cj */ = x36;
                        lua_Unsigned x38 /* ui */ = ((lua_Unsigned)x32) - 1;
                        if (PALLENE_UNLIKELY(x38 >= x23->sizearray)) {
                            pallene_renormalize_array(L, x23, x38, 49);
                        }
                        const TValue * x39 /* arrslot */ = &x23->array[x38];
                        lua_Integer x40 = ivalue(x39);
                        lua_Unsigned x41 /* ui */ = ((lua_Unsigned)x37) - 1;
                        if (PALLENE_UNLIKELY(x41 >= x27->sizearray)) {
                            pallene_renormalize_array(L, x27, x41, 49);
                        }
                        TValue * x42 /* slot */ = &x27->array[x41];
                        setivalue(x42, x40);
                    }
                    x28 = intop(+, x28, x31);
                }
            }
            x10 = intop(+, x10, x13);
        }
    }
}

static int function_spawn_lua(lua_State *L)
{
    CClosure * x1 = clCvalue(s2v(L->ci->func));
    Udata * x2 /* upvalue table */ = uvalue(&x1->upvalue[0]);
    UValue * x3 /* upvalue array */ = x2->uv;
    (void)x3;
    StackValue* x4 = L->ci->func;
    lua_Integer x12 = ivalue(s2v(x4 + 1));
    lua_Integer x13 = ivalue(s2v(x4 + 2));
    Table * x14 = hvalue(s2v(x4 + 3));
    Table * x15 = hvalue(s2v(x4 + 4));
    lua_Integer x16 = ivalue(s2v(x4 + 5));
    lua_Integer x17 = ivalue(s2v(x4 + 6));
    function_spawn_pallene(L, x12, x13, x14, x15, x16, x17);
    return 0;
}

static void function_step_pallene(
    lua_State * L,
    lua_Integer x1 /* N */,
    lua_Integer x2 /* M */,
    Table * x3 /* curr_cells */,
    Table * x4 /* next_cells */
){
    lua_checkstack(L, 6);
    CClosure * x5 = clCvalue(s2v(L->ci->func));
    Udata * x6 /* upvalue table */ = uvalue(&x5->upvalue[0]);
    UValue * x7 /* upvalue array */ = x6->uv;
    (void)x7;
    {
        lua_Integer x8 /* start */ = 1;
        lua_Integer x9 /* limit */ = x1;
        lua_Integer x10 /* step */ = 1;
        while ((x10 >= 0 ? x8 <= x9 : x8 >= x9)) {
            lua_Integer x11 /* i2 */ = x8;
            (void) x11;
            {
                lua_Integer x12 = intop(-, x11, 1);
                StackValue* x13 = L->top;
                sethvalue(L, s2v(x13), x3); x13++;
                sethvalue(L, s2v(x13), x4); x13++;
                L->top = x13;
                lua_Integer x14 = function_wrap_pallene(L, x12, x1);
                L->top -= 2;
                lua_Integer x15 /* i1 */ = x14;
                lua_Integer x16 = intop(+, x11, 1);
                StackValue* x17 = L->top;
                sethvalue(L, s2v(x17), x3); x17++;
                sethvalue(L, s2v(x17), x4); x17++;
                L->top = x17;
                lua_Integer x18 = function_wrap_pallene(L, x16, x1);
                L->top -= 2;
                lua_Integer x19 /* i3 */ = x18;
                lua_Unsigned x20 /* ui */ = ((lua_Unsigned)x15) - 1;
                if (PALLENE_UNLIKELY(x20 >= x3->sizearray)) {
                    pallene_renormalize_array(L, x3, x20, 61);
                }
                const TValue * x21 /* arrslot */ = &x3->array[x20];
                Table * x22 = hvalue(x21);
                Table * x23 /* cells1 */ = x22;
                lua_Unsigned x24 /* ui */ = ((lua_Unsigned)x11) - 1;
                if (PALLENE_UNLIKELY(x24 >= x3->sizearray)) {
                    pallene_renormalize_array(L, x3, x24, 62);
                }
                const TValue * x25 /* arrslot */ = &x3->array[x24];
                Table * x26 = hvalue(x25);
                Table * x27 /* cells2 */ = x26;
                lua_Unsigned x28 /* ui */ = ((lua_Unsigned)x19) - 1;
                if (PALLENE_UNLIKELY(x28 >= x3->sizearray)) {
                    pallene_renormalize_array(L, x3, x28, 63);
                }
                const TValue * x29 /* arrslot */ = &x3->array[x28];
                Table * x30 = hvalue(x29);
                Table * x31 /* cells3 */ = x30;
                lua_Unsigned x32 /* ui */ = ((lua_Unsigned)x11) - 1;
                if (PALLENE_UNLIKELY(x32 >= x4->sizearray)) {
                    pallene_renormalize_array(L, x4, x32, 65);
                }
                const TValue * x33 /* arrslot */ = &x4->array[x32];
                Table * x34 = hvalue(x33);
                Table * x35 /* next2 */ = x34;
                lua_Integer x36 /* start */ = 1;
                lua_Integer x37 /* limit */ = x2;
                lua_Integer x38 /* step */ = 1;
                while ((x38 >= 0 ? x36 <= x37 : x36 >= x37)) {
                    lua_Integer x39 /* j2 */ = x36;
                    (void) x39;
                    {
                        lua_Integer x40 = intop(-, x39, 1);
                        StackValue* x41 = L->top;
                        sethvalue(L, s2v(x41), x3); x41++;
                        sethvalue(L, s2v(x41), x4); x41++;
                        sethvalue(L, s2v(x41), x23); x41++;
                        sethvalue(L, s2v(x41), x27); x41++;
                        sethvalue(L, s2v(x41), x31); x41++;
                        sethvalue(L, s2v(x41), x35); x41++;
                        L->top = x41;
                        lua_Integer x42 = function_wrap_pallene(L, x40, x2);
                        L->top -= 6;
                        lua_Integer x43 /* j1 */ = x42;
                        lua_Integer x44 = intop(+, x39, 1);
                        StackValue* x45 = L->top;
                        sethvalue(L, s2v(x45), x3); x45++;
                        sethvalue(L, s2v(x45), x4); x45++;
                        sethvalue(L, s2v(x45), x23); x45++;
                        sethvalue(L, s2v(x45), x27); x45++;
                        sethvalue(L, s2v(x45), x31); x45++;
                        sethvalue(L, s2v(x45), x35); x45++;
                        L->top = x45;
                        lua_Integer x46 = function_wrap_pallene(L, x44, x2);
                        L->top -= 6;
                        lua_Integer x47 /* j3 */ = x46;
                        lua_Unsigned x48 /* ui */ = ((lua_Unsigned)x43) - 1;
                        if (PALLENE_UNLIKELY(x48 >= x23->sizearray)) {
                            pallene_renormalize_array(L, x23, x48, 71);
                        }
                        const TValue * x49 /* arrslot */ = &x23->array[x48];
                        lua_Integer x50 = ivalue(x49);
                        lua_Integer x51 /* c11 */ = x50;
                        lua_Unsigned x52 /* ui */ = ((lua_Unsigned)x39) - 1;
                        if (PALLENE_UNLIKELY(x52 >= x23->sizearray)) {
                            pallene_renormalize_array(L, x23, x52, 72);
                        }
                        const TValue * x53 /* arrslot */ = &x23->array[x52];
                        lua_Integer x54 = ivalue(x53);
                        lua_Integer x55 /* c12 */ = x54;
                        lua_Unsigned x56 /* ui */ = ((lua_Unsigned)x47) - 1;
                        if (PALLENE_UNLIKELY(x56 >= x23->sizearray)) {
                            pallene_renormalize_array(L, x23, x56, 73);
                        }
                        const TValue * x57 /* arrslot */ = &x23->array[x56];
                        lua_Integer x58 = ivalue(x57);
                        lua_Integer x59 /* c13 */ = x58;
                        lua_Unsigned x60 /* ui */ = ((lua_Unsigned)x43) - 1;
                        if (PALLENE_UNLIKELY(x60 >= x27->sizearray)) {
                            pallene_renormalize_array(L, x27, x60, 75);
                        }
                        const TValue * x61 /* arrslot */ = &x27->array[x60];
                        lua_Integer x62 = ivalue(x61);
                        lua_Integer x63 /* c21 */ = x62;
                        lua_Unsigned x64 /* ui */ = ((lua_Unsigned)x39) - 1;
                        if (PALLENE_UNLIKELY(x64 >= x27->sizearray)) {
                            pallene_renormalize_array(L, x27, x64, 76);
                        }
                        const TValue * x65 /* arrslot */ = &x27->array[x64];
                        lua_Integer x66 = ivalue(x65);
                        lua_Integer x67 /* c22 */ = x66;
                        lua_Unsigned x68 /* ui */ = ((lua_Unsigned)x47) - 1;
                        if (PALLENE_UNLIKELY(x68 >= x27->sizearray)) {
                            pallene_renormalize_array(L, x27, x68, 77);
                        }
                        const TValue * x69 /* arrslot */ = &x27->array[x68];
                        lua_Integer x70 = ivalue(x69);
                        lua_Integer x71 /* c23 */ = x70;
                        lua_Unsigned x72 /* ui */ = ((lua_Unsigned)x43) - 1;
                        if (PALLENE_UNLIKELY(x72 >= x31->sizearray)) {
                            pallene_renormalize_array(L, x31, x72, 79);
                        }
                        const TValue * x73 /* arrslot */ = &x31->array[x72];
                        lua_Integer x74 = ivalue(x73);
                        lua_Integer x75 /* c31 */ = x74;
                        lua_Unsigned x76 /* ui */ = ((lua_Unsigned)x39) - 1;
                        if (PALLENE_UNLIKELY(x76 >= x31->sizearray)) {
                            pallene_renormalize_array(L, x31, x76, 80);
                        }
                        const TValue * x77 /* arrslot */ = &x31->array[x76];
                        lua_Integer x78 = ivalue(x77);
                        lua_Integer x79 /* c32 */ = x78;
                        lua_Unsigned x80 /* ui */ = ((lua_Unsigned)x47) - 1;
                        if (PALLENE_UNLIKELY(x80 >= x31->sizearray)) {
                            pallene_renormalize_array(L, x31, x80, 81);
                        }
                        const TValue * x81 /* arrslot */ = &x31->array[x80];
                        lua_Integer x82 = ivalue(x81);
                        lua_Integer x83 /* c33 */ = x82;
                        lua_Integer x84 = intop(+, x51, x55);
                        lua_Integer x85 = intop(+, x84, x59);
                        lua_Integer x86 = intop(+, x85, x63);
                        lua_Integer x87 = intop(+, x86, x71);
                        lua_Integer x88 = intop(+, x87, x75);
                        lua_Integer x89 = intop(+, x88, x79);
                        lua_Integer x90 = intop(+, x89, x83);
                        lua_Integer x91 /* sum */ = x90;
                        {
                            int x92 = x91 == 3;
                            int x93 = x92;
                            if (!x93) {
                                int x94 = x91 == 2;
                                int x95 = x94;
                                if (x95) {
                                    int x96 = x67 == 1;
                                    x95 = x96;
                                }
                                x93 = x95;
                            }
                            if (x93) {
                                lua_Unsigned x97 /* ui */ = ((lua_Unsigned)x39) - 1;
                                if (PALLENE_UNLIKELY(x97 >= x35->sizearray)) {
                                    pallene_renormalize_array(L, x35, x97, 89);
                                }
                                TValue * x98 /* slot */ = &x35->array[x97];
                                setivalue(x98, 1);
                            } else {
                                lua_Unsigned x99 /* ui */ = ((lua_Unsigned)x39) - 1;
                                if (PALLENE_UNLIKELY(x99 >= x35->sizearray)) {
                                    pallene_renormalize_array(L, x35, x99, 91);
                                }
                                TValue * x100 /* slot */ = &x35->array[x99];
                                setivalue(x100, 0);
                            }
                        }
                    }
                    x36 = intop(+, x36, x38);
                }
            }
            x8 = intop(+, x8, x10);
        }
    }
}

static int function_step_lua(lua_State *L)
{
    CClosure * x1 = clCvalue(s2v(L->ci->func));
    Udata * x2 /* upvalue table */ = uvalue(&x1->upvalue[0]);
    UValue * x3 /* upvalue array */ = x2->uv;
    (void)x3;
    StackValue* x4 = L->ci->func;
    lua_Integer x10 = ivalue(s2v(x4 + 1));
    lua_Integer x11 = ivalue(s2v(x4 + 2));
    Table * x12 = hvalue(s2v(x4 + 3));
    Table * x13 = hvalue(s2v(x4 + 4));
    function_step_pallene(L, x10, x11, x12, x13);
    return 0;
}

int luaopen_benchmarks_conway_nocheck(lua_State *L)
{
    lua_checkstack(L, 4);
    /* Allocate upvalue table */
    /* ---------------------- */
    Udata * x1 = luaS_newudata(L, 0, 15);
    UValue * x2 = x1->uv;
    /* Initialize upvalues */
    /* ------------------- */
    TString * x3 = luaS_new(L, "__index");
    setsvalue(L,  &x2[0].uv , x3);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x3))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    TString * x4 = luaS_new(L, "__newindex");
    setsvalue(L,  &x2[1].uv , x4);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x4))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    TString * x5 = luaS_new(L, "__metatable");
    setsvalue(L,  &x2[2].uv , x5);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x5))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    TString * x6 = luaS_new(L, "*");
    setsvalue(L,  &x2[3].uv , x6);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x6))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    TString * x7 = luaS_new(L, " ");
    setsvalue(L,  &x2[4].uv , x7);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x7))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    TString * x8 = luaS_new(L, "");
    setsvalue(L,  &x2[5].uv , x8);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x8))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    TString * x9 = luaS_new(L, "|");
    setsvalue(L,  &x2[6].uv , x9);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x9))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    TString * x10 = luaS_new(L, "|\n");
    setsvalue(L,  &x2[7].uv , x10);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x10))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    /* ALIVE */
    TValue * x11 =  &x2[3].uv ;
    TString * x12 = tsvalue(x11);
    setsvalue(L,  &x2[8].uv , x12);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x12))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    /* DEAD */
    TValue * x13 =  &x2[4].uv ;
    TString * x14 = tsvalue(x13);
    setsvalue(L,  &x2[9].uv , x14);
    if (isblack(obj2gco(x1)) && iswhite(obj2gco(x14))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    /* new_canvas */
    CClosure* x15 = luaF_newCclosure(L, 1);
    x15->f = function_new_canvas_lua;
    setuvalue(L, &x15->upvalue[0], x1);
    TValue x16; setclCvalue(L, &x16, x15);
    setobj(L,  &x2[10].uv , &x16);
    if (iscollectable(&x16) && isblack(obj2gco(x1)) && iswhite(gcvalue(&x16))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    /* wrap */
    CClosure* x17 = luaF_newCclosure(L, 1);
    x17->f = function_wrap_lua;
    setuvalue(L, &x17->upvalue[0], x1);
    TValue x18; setclCvalue(L, &x18, x17);
    setobj(L,  &x2[11].uv , &x18);
    if (iscollectable(&x18) && isblack(obj2gco(x1)) && iswhite(gcvalue(&x18))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    /* draw */
    CClosure* x19 = luaF_newCclosure(L, 1);
    x19->f = function_draw_lua;
    setuvalue(L, &x19->upvalue[0], x1);
    TValue x20; setclCvalue(L, &x20, x19);
    setobj(L,  &x2[12].uv , &x20);
    if (iscollectable(&x20) && isblack(obj2gco(x1)) && iswhite(gcvalue(&x20))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    /* spawn */
    CClosure* x21 = luaF_newCclosure(L, 1);
    x21->f = function_spawn_lua;
    setuvalue(L, &x21->upvalue[0], x1);
    TValue x22; setclCvalue(L, &x22, x21);
    setobj(L,  &x2[13].uv , &x22);
    if (iscollectable(&x22) && isblack(obj2gco(x1)) && iswhite(gcvalue(&x22))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    /* step */
    CClosure* x23 = luaF_newCclosure(L, 1);
    x23->f = function_step_lua;
    setuvalue(L, &x23->upvalue[0], x1);
    TValue x24; setclCvalue(L, &x24, x23);
    setobj(L,  &x2[14].uv , &x24);
    if (iscollectable(&x24) && isblack(obj2gco(x1)) && iswhite(gcvalue(&x24))) {
        luaC_barrierback_(L, obj2gco(x1));
    }
    /* Create exports table */
    /* -------------------- */
    StackValue* x25 = L->top;
    setuvalue(L, s2v(x25), x1); x25++;
    L->top = x25;
    lua_createtable(L, 0, 5);
    lua_pushstring(L, "new_canvas");
    setobj(L, s2v(L->top),  &x2[10].uv ); api_incr_top(L);
    lua_settable(L, -3);
    lua_pushstring(L, "wrap");
    setobj(L, s2v(L->top),  &x2[11].uv ); api_incr_top(L);
    lua_settable(L, -3);
    lua_pushstring(L, "draw");
    setobj(L, s2v(L->top),  &x2[12].uv ); api_incr_top(L);
    lua_settable(L, -3);
    lua_pushstring(L, "spawn");
    setobj(L, s2v(L->top),  &x2[13].uv ); api_incr_top(L);
    lua_settable(L, -3);
    lua_pushstring(L, "step");
    setobj(L, s2v(L->top),  &x2[14].uv ); api_incr_top(L);
    lua_settable(L, -3);
    return 1;
}

